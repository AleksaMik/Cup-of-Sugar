(this["webpackJsonpcup-of-sugar"]=this["webpackJsonpcup-of-sugar"]||[]).push([[0],{198:function(e,t){},211:function(e,t,a){},216:function(e,t){},218:function(e,t){},230:function(e,t){},232:function(e,t){},260:function(e,t){},262:function(e,t){},263:function(e,t){},268:function(e,t){},270:function(e,t){},276:function(e,t){},278:function(e,t){},297:function(e,t){},309:function(e,t){},312:function(e,t){},337:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(193),s=a.n(c),i=(a(211),a(4)),o=a(201),l=a(8),d=a(202),u=a(354),j=a(356),b=a(359),h=a(199),O=a(12),p=a(22),m=a(16),v=a(10),x=a(355),f=a(353),g=a(350),w=a(349),k=a(50),y=a.n(k),S=a(62),C=a(6),I=function(){var e=Object(n.useState)({username:"",email:"",password:""}),t=Object(v.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),s=Object(v.a)(c,1)[0],o=Object(n.useState)(!1),l=Object(v.a)(o,2),d=l[0],u=l[1],j=Object(w.a)(S.ADD_USER),b=Object(v.a)(j,2),h=b[0],k=b[1].error,I=function(e){var t=e.target,n=t.name,c=t.value;r(Object(i.a)(Object(i.a)({},a),{},Object(m.a)({},n,c)))},q=function(){var e=Object(p.a)(Object(O.a)().mark((function e(t){var n,c;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),!1===t.currentTarget.checkValidity()&&(t.preventDefault(),t.stopPropagation()),e.prev=3,e.next=6,h({variables:Object(i.a)({},a)});case 6:n=e.sent,c=n.data,y.a.login(c.addUser.token),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(k),u(!0);case 15:r({username:"",email:"",password:""});case 16:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(x.a,{noValidate:!0,validated:s,onSubmit:q,children:[Object(C.jsx)(f.a,{dismissible:!0,onClose:function(){return u(!1)},show:d,variant:"danger",children:"Something went wrong with your signup!"}),Object(C.jsxs)(x.a.Group,{children:[Object(C.jsx)(x.a.Label,{htmlFor:"username",children:"Username"}),Object(C.jsx)(x.a.Control,{type:"text",placeholder:"Your username",name:"username",onChange:I,value:a.username,required:!0}),Object(C.jsx)(x.a.Control.Feedback,{type:"invalid",children:"Username is required!"})]}),Object(C.jsxs)(x.a.Group,{children:[Object(C.jsx)(x.a.Label,{htmlFor:"email",children:"Email"}),Object(C.jsx)(x.a.Control,{type:"email",placeholder:"Your email address",name:"email",onChange:I,value:a.email,required:!0}),Object(C.jsx)(x.a.Control.Feedback,{type:"invalid",children:"Email is required!"})]}),Object(C.jsxs)(x.a.Group,{children:[Object(C.jsx)(x.a.Label,{htmlFor:"password",children:"Password"}),Object(C.jsx)(x.a.Control,{type:"password",placeholder:"Your password",name:"password",onChange:I,value:a.password,required:!0}),Object(C.jsx)(x.a.Control.Feedback,{type:"invalid",children:"Password is required!"})]}),Object(C.jsx)(g.a,{disabled:!(a.username&&a.email&&a.password),type:"submit",variant:"success",children:"Submit"})]})})},q=function(){var e=Object(n.useState)({email:"",password:""}),t=Object(v.a)(e,2),a=t[0],r=t[1],c=Object(w.a)(S.LOGIN_USER),s=Object(v.a)(c,2),o=s[0],l=s[1].error,d=Object(n.useState)(!1),u=Object(v.a)(d,1)[0],j=Object(n.useState)(!1),b=Object(v.a)(j,2),h=b[0],k=b[1],I=function(e){var t=e.target,n=t.name,c=t.value;r(Object(i.a)(Object(i.a)({},a),{},Object(m.a)({},n,c)))},q=function(){var e=Object(p.a)(Object(O.a)().mark((function e(t){var n,c;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),!1===t.currentTarget.checkValidity()&&(t.preventDefault(),t.stopPropagation()),e.prev=3,e.next=6,o({variables:Object(i.a)({},a)});case 6:n=e.sent,c=n.data,y.a.login(c.login.token),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(l),k(!0);case 15:r({username:"",email:"",password:""});case 16:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(x.a,{noValidate:!0,validated:u,onSubmit:q,children:[Object(C.jsx)(f.a,{dismissible:!0,onClose:function(){return k(!1)},show:h,variant:"danger",children:"Something went wrong with your login credentials!"}),Object(C.jsxs)(x.a.Group,{children:[Object(C.jsx)(x.a.Label,{htmlFor:"email",children:"Email"}),Object(C.jsx)(x.a.Control,{type:"text",placeholder:"Your email",name:"email",onChange:I,value:a.email,required:!0}),Object(C.jsx)(x.a.Control.Feedback,{type:"invalid",children:"Email is required!"})]}),Object(C.jsxs)(x.a.Group,{children:[Object(C.jsx)(x.a.Label,{htmlFor:"password",children:"Password"}),Object(C.jsx)(x.a.Control,{type:"password",placeholder:"Your password",name:"password",onChange:I,value:a.password,required:!0}),Object(C.jsx)(x.a.Control.Feedback,{type:"invalid",children:"Password is required!"})]}),Object(C.jsx)(g.a,{disabled:!(a.email&&a.password),type:"submit",variant:"success",children:"Submit"})]})})},E=function(){return Object(C.jsxs)("div",{children:[Object(C.jsx)(I,{}),Object(C.jsx)(q,{})]})};var F=function(){return Object(C.jsx)("div",{children:"SearchRentals"})},R=a(357),_=function(e){e.length?localStorage.setItem("saved_rentals",JSON.stringify(e)):localStorage.removeItem("saved_rentals")},N=function(e){var t=localStorage.getItem("saved_rentals")?JSON.parse(localStorage.getItem("saved_rentals")):null;if(!savedRentalsIds)return!1;var a=null===t||void 0===t?void 0:t.filter((function(t){return t!==e}));return localStorage.setItem("saved_rental",JSON.stringify(a)),!0},T=a(198),D=function(){var e=Object(R.a)(T.GET_ME).data,t=(null===e||void 0===e?void 0:e.me)||[],a=Object(w.a)(S.REMOVE_RENTAL),n=Object(v.a)(a,2),r=n[0],c=n[1].error,s=function(){var e=Object(p.a)(Object(O.a)().mark((function e(t){return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.a.loggedIn()?y.a.getToken():null){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,r({variables:{rentalId:t}});case 6:if(e.sent){e.next=9;break}throw new Error("Sorry, something went wrong");case 9:N(t),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(c);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();t.savedRentals.map((function(e){return e.rentalId}));return _(_),Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(Jumbotron,{fluid:!0,className:"text-light bg-dark",children:[" ",Object(C.jsx)(Container,{children:Object(C.jsx)("h1",{children:"Viewing saved books!"})})]}),Object(C.jsxs)(Container,{children:[Object(C.jsx)("h2",{children:t.savedRentals.length?"Viewing ".concat(t.savedRentals.length," saved ").concat(1===t.savedRentals.length?"rental":"rentals",":"):"No saved rentals!"}),t.savedRentals.map((function(e){return Object(C.jsx)(Card,{border:"dark",children:Object(C.jsxs)(Card.Body,{children:[Object(C.jsx)(Card.Title,{children:e.title}),Object(C.jsx)(Card.Text,{children:"(rental.description)"}),Object(C.jsx)(Button,{className:"btn-block btn-danger",onClick:function(){return s(e.rentalId)},children:"Delete this Rental!"})]})},e.rentalId)}))]})]})},G=Object(d.a)({uri:"/graphql"}),L=Object(h.a)((function(e,t){var a=t.headers,n=localStorage.getItem("id_token");return{headers:Object(i.a)(Object(i.a)({},a),{},{authorization:n?"Bearer ".concat(n):""})}})),P=new u.a({link:L.concat(G),cache:new j.a});var V=function(){return Object(C.jsx)(b.a,{client:P,children:Object(C.jsx)(o.a,{children:Object(C.jsx)("div",{children:Object(C.jsxs)(l.c,{children:[Object(C.jsx)(l.a,{path:"/",element:Object(C.jsx)(E,{})}),Object(C.jsx)(l.a,{path:"/search",element:Object(C.jsx)(F,{})}),Object(C.jsx)(l.a,{path:"/saved",element:Object(C.jsx)(D,{})}),Object(C.jsx)(l.a,{path:"/post",element:Object(C.jsx)(Post,{})})]})})})})};s.a.render(Object(C.jsx)(r.a.StrictMode,{children:Object(C.jsx)(V,{})}),document.getElementById("root"))},50:function(e,t,a){var n=a(212),r="supersecret";e.exports={authMiddleware:function(e){var t=e.req,a=t.body.token||t.query.token||t.headers.authorization;if(t.headers.authorization&&(a=a.split(" ").pop().trim()),!a)return t;try{var c=n.verify(a,r,{maxAge:"2h"}).data;t.user=c}catch(s){console.log("Invalid token")}return t},signToken:function(e){var t={email:e.email,name:e.name,_id:e._id};return n.sign({data:t},r,{expiresIn:"2h"})}}},62:function(e,t){}},[[337,1,2]]]);
//# sourceMappingURL=main.9e4fbca9.chunk.js.map